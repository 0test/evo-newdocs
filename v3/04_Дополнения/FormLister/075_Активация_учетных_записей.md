# Активация учетных записей

Контроллер `Activate` реализует активацию учетных записей. Таким образом появляется возможность требовать у пользователя подтверждение учетной записи путем перехода по специальной ссылке из письма, отправленного при регистрации на указанный пользователем `email`.

Если по какой-то причине пользователь не получил письмо, то c помощью контроллера `Activate` он может запросить его повторную отправку.

Учетная запись пользователя считается неактивированной если в поле `verified` записано `0`.

В вызовах сниппета для регистрации и авторизации пользователей должен присутствовать параметр `&checkActivation='1'`. При редактировании профиля предусмотрена возможность сбросить активацию при изменении определенного поля (по умолчанию `email`).

Поэтому если при регистрации пользователь указывал пароль самостоятельно, то обязательно нужно запрашивать пароль для отправки письма со ссылкой для активации. Иначе будет генерироваться новый пароль, потому что раз пользователь запрашивает письмо для активации вручную, значит письмо после регистрации он не получил и не знает созданный при регистрации пароль.

В шаблонах доступны все поля модели для обрабатываемой записи. В шаблоне `reportTpl` задается поле `user.password` с незашифрованным паролем и поле `activate.url` со ссылкой для активации.

## Параметры

| параметр                                        | описание                                          | умолч.                                    |
| ----------------------------------------------- | ------------------------------------------------- | ----------------------------------------- |
| [model](#param_model)                           | имя класса                                        | `\modUsers`                               |
| [modelPath](#param_modelpath)                   | путь к файлу класса                               | `assets/lib/MODxAPI/modUsers.php`         |
| [uidName](#param_uidname)                       | имя get-параметра для востановления пароля        | см. описание                              |
| [redirectTo](#param_redirectto)                 | перенаправить после регистрации                   |                                           |
| [exitTo](#param_exitto)                         | перенаправить уже авторизованного                 |                                           |
| [skipTpl](#param_skiptpl)                       | шаблон сообщения для уже авторизованного          | `[+register.default_skipTpl+]`            |
| [reportTpl](#param_reporttpl)                   | шаблон письма с информацией для активации         |                                           |
| [activateReportTpl](#param_activatereporttpl)   | шаблон письма об успешной активации               |                                           |
| [successTpl](#param_successtpl)                 | шаблон сообщения об отправке письма для активации | `[+activate.default_successTpl+]`         |
| [activateSuccessTpl](#param_activatesuccesstpl) | шаблон сообщения об успешной активации            | `[+activate.default_activateSuccessTpl+]` |
| [passwordLength](#param_passwordlength)         | длина пароля                                      | `6`                                       |

### <a name="param_model"></a> model

Класс для работы с пользователями.

_Значения:_ имя класса. Для Evo 3.x следует использовать модель `Pathologic\EvolutionCMS\MODxAPI\modUsers` из пакета `pathologic/modxapi`.

_По умолчанию:_ `\modUsers`

### <a name="param_modelpath"></a> modelPath

Путь к файлу класса для работы с пользователями.

_Значения:_ относительный путь к файлу.

_По умолчанию:_ `assets/lib/MODxAPI/modUsers.php`

### <a name="param_uidname"></a> uidName

Имя GET-параметра в ссылке для активации, который содержит id пользователя.

_По умолчанию:_ primary key для таблицы с пользователями.

### <a name="param_redirectto"></a> redirectTo

Перенаправляет пользователя на указанную страницу после активации.

_Значения:_ id целевой страницы или массив.

_По умолчанию:_ нет значения.

### <a name="param_exitto"></a> exitTo

Перенаправляет авторизованного пользователя на указанную страницу.

_Значения:_ id целевой страницы или массив.

_По умолчанию:_ нет значения.

### <a name="param_skiptpl"></a> skipTpl

Шаблон сообщения для авторизованного пользователя.

_Значения:_ имя шаблона, указанное по правилам задания шаблонов в DocLister.

_По умолчанию:_ запись из лексикона `Register` с ключом `[+register.default_skipTpl+]`

### <a name="param_reporttpl"></a> reportTpl

Шаблон письма с информацией для активации учетной записи.

_Значения:_ имя шаблона, указанное по правилам задания шаблонов в DocLister.

_По умолчанию:_ нет значения.

### <a name="param_activatereporttpl"></a> activateReportTpl

Шаблон письма об успешной активации учетной записи.

_Значения:_ имя шаблона, указанное по правилам задания шаблонов в DocLister.

_По умолчанию:_ нет значения.

### <a name="param_successtpl"></a> successTpl

Шаблон сообщения об успешной отправке письма с данными для активации.

_Значения:_ имя шаблона, указанное по правилам задания шаблонов в DocLister.

_По умолчанию:_ запись из лексикона `Activate` с ключом `[+activate.default_successTpl+]`

### <a name="param_activatesuccesstpl"></a> activateSuccessTpl

Шаблон сообщения об успешной активации.

_Значения:_ имя шаблона, указанное по правилам задания шаблонов в DocLister.

_По умолчанию:_ запись из лексикона `Activate` с ключом `[+activate.default_activateSuccessTpl+]`

### <a name="param_passwordlength"></a> passwordLength

Длина создаваемого пароля.

_Значения:_ число символов больше 6.

_По умолчанию:_ `6`.
