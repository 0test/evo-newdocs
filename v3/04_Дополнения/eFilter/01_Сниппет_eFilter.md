# Сниппет eFilter

Вывод формы для фильтрация.

Содержание:

- [Параметры](#params)
- [Плейсхолдеры](#plhs)
- [Шаблоны](#tpls)
- [ajax](#ajax)

## <a name="params"></a> Параметры

| параметр                          | описание           | умолч.             |
| --------------------------------- | ------------------ | ------------------ |
| [js](#param_js)                   | подключить js      | `1`                |
| [css](#param_css)                 | подключить css     | `1`                |
| [sliderCssJs](#param_slidercssjs) | подключить слайдер | `1`                |
| [ajax](#param_ajax)               | фильтр с ajax      | `0`                |
| [autoSubmit](#param_autosubmit)   | автоотправка формы |                    |
| [filters](#param_filters)         | фильтры доклистер  |                    |
| [tv_config](#param_tvconfig)      | конфигурация       | поле `tovarparams` |

### <a name="param_js"></a> js

Подключение js скриптов фильтра.

_Значения:_ `0`, `1`.

_По умолчанию:_ `1`.

### <a name="param_css"></a> css

Подключение css стилей фильтра.

_Значения:_ `0`, `1`.

_По умолчанию:_ `1`.

### <a name="param_slidercssjs"></a> sliderCssJs

Подключение js скриптов и css стилей слайдер (цена).

_Значения:_ `0`, `1`.

_По умолчанию:_ `1`.

### <a name="param_ajax"></a> ajax

Использовать фильтрацию без перезагрузки страницы.

_Значения:_ `0`, `1`.

_По умолчанию:_ `0`.

### <a name="param_autosubmit"></a> autoSubmit

Автосабмит формы при изменении ее параметров.

_Значения:_ `0`, `1`.

_По умолчанию:_ ?.

### <a name="param_filters"></a> filters

Параметр для фильтация отбора товаров. Формат DoсLister.

### <a name="param_tvconfig"></a> tv_config

JSON масив из конфигурацией формы фильтрации.

_По умолчанию:_ поле `tovarparams` ресурса текущего или его родителей.

## <a name="plhs"></a> Плейсхолдеры

| плейсхолдер                                   | описание                                 | умолч.                |
| --------------------------------------------- | ---------------------------------------- | --------------------- |
| [eFilter_ids](#plh_efilterids)                | список для вывода                        |                       |
| [eFilter_form](#plh_efilterform)              | форма фильтра                            |                       |
| [eFilter_form_delete](#plh_eFilterformdelete) | форма удаления фильтров                  |                       |
| [docid](#plh_docid)                           | категория для получения товаров          | id текущего документа |
| [cfg](#plh_cfg)                               | файл конфигурации шаблона формы          | `default`             |
| [delete_cfg](#plh_deletecfg)                  | файл конфигурации шаблона формы удаления | `default`             |
| [removeDisabled](#plh_removedisabled)         | скрывать неактивные элементы             | `0`                   |
| [nosortTvId](#plh_nosorttvid)                 | какие значения тв не сортировать         |                       |

### <a name="plh_efilterids"></a> eFilter_ids

Список документов для вывода (подставляем в `DocLister`, это происходит автоматом в сниппете `getFilteredItems`).

### <a name="plh_efilterform"></a> eFilter_form

Форма вывода фильтра - вставить плейсхолдер в нужное место шаблона.

### <a name="plh_eFilterformdelete"></a> eFilter_form_delete

Форма удаления установленных фильтров.

### <a name="plh_docid"></a> docid

Ид категории для получения товаров.

_По умолчанию:_ `id` текущего документа.

### <a name="plh_cfg"></a> cfg

Название файла с конфигурацие html шаблона элементов формы фильтрации.

Имя файла должно быть в формате `config.название_конфигурации.php`.

_По умолчанию:_ `default`.

### <a name="plh_deletecfg"></a> delete_cfg

Название файла с конфигурацие html шаблона элементов формы для удаление выбраних параметров фильтрации.

Имя файла должно быть в формате `config.delete.название_конфигурации.php`.

_По умолчанию:_ `default`.

### <a name="plh_removedisabled"></a> removeDisabled

Скрывать неактивные варианты параметров из формы.

_Значения:_ `1`, `0`.

_По умолчанию:_ `0`.

### <a name="plh_nosorttvid"></a> nosortTvId

Список тв параметров варианты которых не нужно сортировать.

## <a name="tpls"></a> Шаблоны

Содержание:

- [Форма фильтра](#tpl_filter)
- [Форма сбоса фильтров](#tpl_filter_reset)

### <a name="tpl_filter"></a> Форма фильтра

Шаблоны хранятся в файле с расширением `php` в переменных.

Если нужно для определённого тв параметра указать свой шаблон - необходимо создать переменную в фомате `ТипШабнона_ИмяПеременной`.

_Пример:_ если тв параметр называется `frameSize`, то обертка будет `tplRowCheckbox_frameSize` и ссылка будет `tplOuterCheckbox_frameSize`.

#### Плейсхолдеры обертки формы

|               |                |
| ------------- | -------------- |
| `[+url+]`     | адрес страницы |
| `[+wrapper+]` | элементы формы |

Для работы `ajax` у формы должен быть `id` со значением `eFiltr`.

#### Плейсхолдеры обертки параметра

|               |                       |
| ------------- | --------------------- |
| `[+tv_id+]`   | id тв параметра       |
| `[+name+]`    | название тв параметра |
| `[+wrapper+]` | список вариантов      |

#### Плейсхолдеры элементов формы (не диапазон или слайдер)

|                |                                                                                                                |
| -------------- | -------------------------------------------------------------------------------------------------------------- |
| `[+tv_id+]`    | id тв параметра                                                                                                |
| `[+name+]`     | если используем `checkbox`, `radio` или `dropDown` то `List Menu` вернет текстовое значение варианта параметра |
| `[+value+]`    | значение параметра                                                                                             |
| `[+selected+]` | если выбран вариант параметра вернет `checked` или `selected`                                                  |
| `[+disabled+]` | если выбрать нельзя вернет `disabled`                                                                          |
| `[+count+]`    | доступное количество товаров из вариантом параметра                                                            |

#### Плейсхолдеры элементов формы диапазон или слайдер

|                  |                                                                                                                |
| ---------------- | -------------------------------------------------------------------------------------------------------------- |
| `[+tv_id+]`      | `id` тв параметра                                                                                              |
| `[+name+]`       | если используем `checkbox`, `radio` или `dropDown` то `List Menu` вернет текстовое значение варианта параметра |
| `[+value+]`      | значение параметра                                                                                             |
| `[+selected+]`   | если выбран вариант параметра вернет `checked` или `selected`                                                  |
| `[+disabled+]`   | если выбрать нельзя вернет `disabled`                                                                          |
| `[+count+]`      | доступное количество товаров из вариантом параметра                                                            |
| `[+minval+]`     | минимальное значение, выбраное пользователем                                                                   |
| `[+maxval+]`     | максимальное значение, выбраное пользователем                                                                  |
| `[+minvalcurr+]` | минимальное значение                                                                                           |
| `[+maxvalcurr+]` | максимальное значение                                                                                          |

### <a name="tpl_filter_reset"></a> Форма сброса фильтров

Если нужно для определёного тв параметра указать свой шаблон необходимо создать переменную в фомате `ТипШабнона_ИмяПеременной`.

_Пример:_ тв параметр `frameSize`, обертка `tplDeleteFilterOwner_frameSize` и ссылка `tplDeleteFilterInner_frameSize`.

#### tplDeleteFilterForm

Обертка формы.

|               |        |
| ------------- | ------ |
| `[+wrapper+]` | данные |

#### tplSliderOwner

Обертка блока для сброса вариантов фильтрации для диапазона или слайдера.

|                    |                                                         |
| ------------------ | ------------------------------------------------------- |
| `[+wrapper+]`      | данные                                                  |
| `[+delete_group+]` | ссылка для сброса всех вариантов фильрации тв параметра |
| `[+name+]`         | имя тв параметра                                        |

#### tplSliderInner

Шаблон вывода ссылки для удаление фильтра диапазона или слайдера.

|            |                                       |
| ---------- | ------------------------------------- |
| `[+link+]` | ссылка для сброса варианта фильтрации |
| `[+min+]`  | минимальное значение                  |
| `[+max+]`  | максимальное значение                 |

#### tplDeleteFilterOwner

Обертка для других блоков.

|                    |                                                         |
| ------------------ | ------------------------------------------------------- |
| `[+wrapper+]`      | данные                                                  |
| `[+delete_group+]` | ссылка для сброса всех вариантов фильрации тв параметра |
| `[+name+]`         | имя тв параметра                                        |

#### tplDeleteFilterInner

Вывод ссылки для сброса варианта фильтра.

|            |                                       |
| ---------- | ------------------------------------- |
| `[+link+]` | ссылка для сброса варианта фильтрации |
| `[+name+]` | значение варианта                     |

## <a name="ajax"></a> ajax

Для работы ajax при сбросе фильтров необходимо:

- Для общей обертки формы сброса задать класс `fltr_delete_wrap`
- Для всех ссылок сброса задать класс `fltr_delete_item_link`
