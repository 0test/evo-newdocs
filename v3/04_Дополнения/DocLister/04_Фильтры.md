# Фильтры

- [Построение фильтра](#construct)
- [Операторы](#operators)
- [Примечания](#comments)

В комплекте следующие фильтры:

- `content` - для фильтрации по полям таблицы `site_content`, можно заменить параметром `addWhereList`;
- `tv` - для фильтрации по TV-параметрам;
- `tvd` - для фильтрации по TV-параметрам с учетом значений по умолчанию;
- `private` - для фильтрации документов с учетом прав доступа.

## <a name="construct"></a> Построение фильтра

Общая струкрура задания фильтра показана в примере: `OR(AND(filter:field:operator:value;filter2:field:operator:value);(...))`

## <a name="operators"></a> Операторы

| Оператор            | Описание                   | Пример                                           |
| ------------------- | -------------------------- | ------------------------------------------------ |
| `=`, `eq`, `is`     | равно                      | `content:pagetitle:=:hello`                      |
| `isnull`            | нет значения               | `content:menutitle:isnull:`                      |
| `!=`, `no`, `isnot` | не равно                   | `content:longtitle:!=:goodbye`                   |
| `isnotnull`         | есть значение              | `content:menutitle:isnotnull:`                   |
| `>`, `gt`           | больше                     | `tv:price:>:1000`                                |
| `<`, `lt`           | меньше                     | `tv:instock:<:50`                                |
| `<=`, `elt`         | меньше или равно           | `tv:price:<=:1000`                               |
| `>=`, `egt`         | больше или равно           | `tv:instock:>=500`                               |
| `%`, `like`         | содержит строку            | `tv:description:%:great`                         |
| `like-r`            | начинается строкой         | `content:pagetitle:like-r:Greates`               |
| `like-l`            | заканчивается строкой      | `content:pagetitle:like-l:world.`                |
| `regexp`            | регулярные выражения       |                                                  |
| `against`           | полнотекстовый поиск       | `content:pagetitle,description:against:space`    |
| `сontainsOne`       | любого слова или его части | `content:content:containsOne:когда,наступит,мир` |
| `in`                | входит в множество         | `content:parent:in:1,2,3`                        |
| `notin`             | не входит в множество      | `content:parent:notin:2,3,4`                     |

## <a name="comments"></a> Примечания

Выборка с использованием регулярных выражений можно по документации по [REGEXP](https://dev.mysql.com/doc/refman/5.5/en/regexp.html)

С параметром `against` для полнотекстового поиска `[[DocLister? &filters='AND(content:pagetitle,description,content,introtext:against:искомая строка)']]` из данного примера предполагается, что в базе данных имеется `FULLTEXT` индекс по полям `pagetitle`, `description`, `content`, `introtext`

С параметром `containsOne` для поиска любого слова или его части в тексте при помощи `LIKE` с вызовом `[[DocLister? &filters='AND(content:content:containsOne:когда,наступит,мир)']]` будет построен SQL запрос вида `(content LIKE '%когда%' OR content LIKE '%наступит%' OR content LIKE '%мир%')`

Т.е. в конечном счете из базы будут выбраны документы в тексте которых используется слова `когда` или `наступит` или `мир`.

Из примера вызова видно, что слова разделены запятой. Это поведение можно переопределить параметром `filter_delimiter`

Можно объединять запросы для построение комбинаций. _Пример:_ вызов с фильтрацией по цене от 0 до 300 `[[DocLister? &filters='AND(tv:price:gt:0;tv:price:lt:300)']]`

А теперь тоже самое, только с учетом значений по умолчанию `[[DocLister? &filters='AND(tvd:price:gt:0;tvd:price:lt:300)']]`
