
Корзина вызывается на всех страницах, где необходима работа магазина -- добавление, редактирование и удаление товаров.

**Совет:** корзина - это обёртка для сниппета DocLister и в ней работают практически все его параметры.

**Как это может пригодиться?**
Скажем, вы хотите показывать в корзине фотографию товара. Пускай она хранится в ТВ с именем `mainphoto`. Как и в DocLister, вам необходимо при помощи параметра `&tvList=mainphoto` указать сниппету, что в выборку включается ТВ.

## Пример вызова ##

```
[!Cart
    &instance=`products`
    &tvList=`image`
!]
```
## Параметры ##

<table>
	<tr>
		<th>Параметр</th>
		<th>Описание</th>
	</tr><tr>
		<td>instance</td>
		<td>
			<p>Тип корзины.</p>
			<p>С помощью сниппета можно вывести корзину с товарами, либо списки избранного или сравнения. Соответственно, значение может быть <code>products</code>, <code>wishlist</code> или <code>comparison</code>. Значение по умолчанию - <code>products</code></p>
			<p>Данные значения предустановлены. Если нужны другие списки, их можно создать в плагине на событие <code>OnInitializeCommerce</code>:</p>
			<pre>ci()->carts->addCart(new \Commerce\Carts\ProductsList($modx, 'listname'));</pre>
		</td>
	</tr><tr>
		<td>theme</td>
		<td>
			<p>Префикс имени шаблонов.</p>
			<p>По умолчанию пустое значение. Можно использовать для темизации корзины, чтобы не указывать все шаблоны по отдельности. Может быть либо префиксом имен файлов, либо именем вложенной папки (тогда в конце нужно указать слэш).</p>
			<p>Изначально доступны шаблоны без префикса и с префиксом "mini", например minicart_wrap и пр. - для миникорзины.</p></td>
	</tr><tr>
		<td>tpl</td>
		<td><p>Шаблон строки корзины, соответствует такому же параметру DocLister</p><p>Помимо стандартных, в шаблоне доступны следующие плейсхолдеры:<br><code>[+original_title+]</code> - название товара из таблицы site_content,<br><code>[+hash+]</code> - хэш-код строки,<br><code>[+count+]</code> - количество данного товара,<br><code>[+price+]</code> - цена товара,<br><code>[+total+]</code> - полная стоимость данного товара,<br><code>[+options+]</code> - опции товара (обработанные или нет, зависит от параметра defaultOptionsRender).</p></td>
	</tr><tr>
		<td>ownerTPL</td>
		<td><p>Шаблон обертки корзины, соответствует такому же параметру DocLister</p><p>Помимо стандартных, в шаблоне доступны следующие плейсхолдеры:<br><code>[+hash+]</code> - хэш-код козины,<br><code>[+items_price+]</code> - суммарная стоимость товаров,<br><code>[+total+]</code> - полная стоимость корзины, с учетом дополнительных сборов,<br><code>[+subtotals+]</code> - дополнительные сборы,<br><code>[+count+]</code> - число товаров в корзине,<br><code>[+rows_count+]</code> - число строк в корзине,<br><code>[+settings+]</code> - массив настроек плагина Commerce.</p></td>
	</tr><tr>
		<td>noneTPL</td>
		<td><p>Шаблон пустой корзины.</p></td>
	</tr><tr>
		<td>optionsTpl</td>
		<td><p>Шаблон строки опций товара. Имеет смысл только при &defaultOptionsRender=`1`. Подразумевается, что опции товара заданы как массив пар ключ => значение.</p><p>В шаблоне доступны следующие значения:<br><code>[+key+]</code> - ключ,<br><code>[+option+]</code> - значение опции.</p></td>
	</tr><tr>
		<td>defaultOptionsRender</td>
		<td><p>Нужно ли рендерить опции товара. Принимает значения 0 или 1, по умолчанию - 1.</p><p>Если структура опций имеет более сложный формат, можно поставить значение 0, а опции обрабатывать в prepare.</p></td>
	</tr><tr>
		<td>subtotalsTpl</td>
		<td><p>Шаблон обертки для дополнительных сборов.</p></td>
	</tr><tr>
		<td>subtotalsRowTpl</td>
		<td><p>Шаблон строки дополнительных сборов.</p><p>Доступные следующие плейсхолдеры:<br><code>[+title+]</code> - название,<br><code>[+price+]</code> - цена.</p></td>
	</tr><tr>
		<td>prepareSubtotalsWrap</td>
		<td><p>prepare для обертки дополнительных сборов, действие аналогично параметру prepareWrap</p></td>
	</tr><tr>
		<td>prepareSubtotalsRow</td>
		<td><p>prepare для строк дополнительных сборов, действие аналогично параметру prepare</p></td>
	</tr>
</table>

Остальные параметры абсолютно аналогичны таковым в сниппете DocLister.

## Шаблоны ##
Все шаблоны по умолчанию лежат в папке `assets/plugins/commerce/templates/front/`. Чтобы изменить вид корзины, можно указать свои чанки с помощью параметров сниппета, либо скопировать все чанки корзины в новую папку и указать имя папки в параметре `theme`.

Не изменяйте чанки по умолчанию напрямую - так при обновлении вы потеряете все изменения.

### Схема шаблона корзины ###

В разметке корзины должны быть обязательные атрибуты, необходимые для корректной работы скриптов.

```
<... data-commerce-cart="[+hash+]">
	<... data-id="[+id+]" data-commerce-row="[+row+]" ...>
		<input type="text" name="count" value="[+count+]" data-commerce-action="recount">
		<... data-commerce-action="decrease" .../>
		<... data-commerce-action="increase" .../>
		<... data-commerce-action="remove" .../>
	</...>
	
	<... data-commerce-action="clean" .../>
</...>      
```

<table width="100%">
	<tr><td><code>data-commerce-cart="[+hash+]"</code></td><td>Атрибут обертки корзины, все содержимое данного тега обновляется при изменениях в корзине</td></tr>
	<tr><td><code>data-id="[+id+]"</code></td><td>Идентификатор товара, присваивается строке корзины</td></tr>
	<tr><td><code>data-commerce-row="[+row+]"</code></td><td>Хеш-код строки корзины, используется для обновления данных в этой строке</td></tr>
	<tr><td><code>data-commerce-action="recount"</code></td><td>Поле с количеством товара</td></tr>
	<tr><td><code>data-commerce-action="decrease"</code></td><td>Элемент, по нажатию на который происходит уменьшение товара в строке на 1</td></tr>
	<tr><td><code>data-commerce-action="increase"</code></td><td>Элемент, по нажатию на который происходит увеличение товара в строке на 1</td></tr>
	<tr><td><code>data-commerce-action="remove"</code></td><td>Элемент, по нажатию на который происходит удаление строки из корзины</td></tr>
	<tr><td><code>data-commerce-action="clean"</code></td><td>Элемент, по нажатию на который происходит очистка корзины</td></tr>
</table>
