# Настройка платежных плагинов

Принцип работы всех платежных плагинов примерно одинаков:

1. Формирование ссылки/формы для оплаты;
2. Перенаправление покупателя на страницу оплаты;
3. Обработка уведомления от платежной системы о статусе платежа.

Чтобы платежный плагин заработал, нужно выполнить несколько шагов:

1. Задать в настройках платежного плагина данные для доступа к API, обычно это идентификатор магазина и секретный ключ, или токен - варианты могут быть разные. Все данные берутся из личного кабинета платежной системы;
2. Задать в настройках платежной системы адреса для уведомлений и перенаправления после оплаты;
4. Задать настройки плагина Commerce: "Page ID for redirect after successfull payment" и "Page ID for redirect after payment error" - идентификаторы страниц, на которые будет происходить переход после успешной оплаты и после ошибки/отмены платежа соответственно.

Адреса для уведомлений и перенаправлений выглядят следующим образом:
<table>
  <tr>
    <th>Назначение</th>
    <th>Тип запроса</th>
    <th>Адрес</th>
  </tr>
  <tr>
    <td>Уведомление магазина о статусе платеже</td>
    <td>POST</td>
    <td><code>https://&lt;ваш домен&gt;/commerce/&lt;payment_code&gt;/payment-process</code></td>
  </tr>
  <tr>
    <td>Перенаправление после успешной оплаты</td>
    <td>POST</td>
    <td><code>https://&lt;ваш домен&gt;/commerce/&lt;payment_code&gt;/payment-success</code></td>
  </tr>
  <tr>
    <td>Перенаправление после ошибки/отмены платежа</td>
    <td>POST</td>
    <td><code>https://&lt;ваш домен&gt;/commerce/&lt;payment_code&gt;/payment-failed</code></td>
  </tr>
</table>

<code>&lt;payment_code&gt;</code> здесь - это символьный идентификатор платежного плагина, обычно представляет собой название платежной системы слитно с маленькой буквы, может быть также указан в документации к плагину. Например, для Paymaster <code>payment_code</code> будет равен <code>paymaster</code>.

Стоит отметить, что эти адреса нужно указывать даже если вы создали отдельные страницы для показа после успешной оплаты и после отмены платежа. Это необходимо для правильной работы платежного плагина, а покупателю в итоге все равно покажутся заданные вами страницы.
